import { Meta, Story, Canvas, Props } from '@storybook/addon-docs/blocks';
import { Autocomplete } from '../../src/autocomplete/Autocomplete';

<Meta
  title="DCXLibrary/Form/Autocomplete/documentation-dynamic"
  component={Autocomplete}
  parameters={{
    viewMode: 'docs',
    previewTabs: {
      canvas: { hidden: true },
    },
  }}
/>

# Autocomplete with Dynamic values (options)

Autocomplete will work with dynamic values in case you need to provide the results from an exteral source like a server API.

## Usage

The usage is quite similar to the previous documentation but you'll use the method **onChange** to populate dyanically the **options** list

```js
export const AutocompleteDemo = () => {
  const [selected, setSelected] = React.useState('');
  const handleSelected = (value: string) => setSelected(value);

  const [serverOptions, setServerOptions] = React.useState<String[]>([]);

  const handleOnChange = (value: string) => {
    switch (value) {
      case 'p':
        setServerOptions(firstSearch);
        break;
      case 'pe':
        setServerOptions(secondSearch);
        break;
      case 'per':
        setServerOptions(thirdSearch);
        break;
      default:
        setServerOptions(['no results']);
    }
  };

  const handleSearch = (value, options) => {
    return options
      .filter((optionsName) =>
        optionsName.toLowerCase().includes(value.toLowerCase())
      )
      .sort((a, b) => {
        if (a < b) {
          return -1;
        }
        if (a > b) {
          return 1;
        }
        return 0;
      });
  };

  return (
    <Autocomplete
      options={serverOptions}
      minCharsBeforeSearch={1}
      debounceMs={1000}
      onSelected={handleSelected}
      hintText="search the list of fruits dynamically"
      onChange={handleOnChange}
      notFoundText=" "
      search={handleSearch}
    />
  );
};
```

<Props of={Autocomplete} />
